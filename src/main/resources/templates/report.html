<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>게시판</title>
    <link rel="stylesheet" type="text/css" href="/src/css/list.css" />
  </head>
  <body>
    <div class="container">
      <!-- Header -->
      <div class="header">
        <div class="site-name">Lost Pets Website</div>
        <nav class="nav-items">
          <a href="report.html">신고</a>
          <a href="adoption.html">입양</a>
          <a href="education.html">교육</a>
          <a class="button" href="index.html">Main</a>
        </nav>
      </div>

      <!-- Banner -->
      <div class="banner">
        <div class="banner-text">
          <h1>Report</h1>
          <p>Subheading for description or instructions</p>
        </div>
      </div>

      <!-- Bulletin Table -->
      <div class="bulletin-header">
        <h2>Bulletin</h2>
        <button class="write-button" onclick="redirectToWrite()">Write</button>
      </div>
      <script>
        const logInFlag = localStorage.getItem("logInFlag"); // Assuming logInFlag is stored in localStorage

        function redirectToWrite() {
          if (logInFlag == 1) {
            window.location.href = "write.html"; // 로그인 상태일 때 글쓰기 페이지로 연결
          } else if (logInFlag == 0 || logInFlag === null) {
            window.location.href = "login.html"; // 비로그인 상태일 때 로그인 페이지로 연결
          }
        }
      </script>
      <table>
        <thead>
          <tr>
            <th>TITLE</th>
            <th>VIEW</th>
            <th>DATE</th>
            <th>COMMENT</th>
          </tr>
        </thead>
        <tbody id="bulletin-list">
          <!-- 게시글 목록은 JavaScript로 동적 추가 -->
        </tbody>
      </table>
    </div>

    <script>
      // Function to load posts from localStorage and display them
      function loadBulletin() {
        const bulletinList = document.getElementById("bulletin-list");

        // Get posts from localStorage
        const posts = JSON.parse(localStorage.getItem("posts")) || [];

        // Loop through each post and create a row
        posts.forEach((post) => {
          const row = document.createElement("tr");
          row.innerHTML = `
                    <td class="bulletin-title">${post.title}</td>
                    <td>${post.view}</td>
                    <td>${post.date}</td>
                    <td>${post.comment}</td>
                `;
          // Add click event to the title for redirection to board.html
          row
            .querySelector(".bulletin-title")
            .addEventListener("click", function () {
              window.location.href = "board.html";
            });
          bulletinList.appendChild(row);
        });
      }

      // Load the posts when the page is loaded
      window.onload = loadBulletin;
    </script>
  </body>
</html>
