<!DOCTYPE HTML>
<html>
  <head>
    <title>User Information</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="assets/css/main.css" />
    <noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
    <style>
      /* Logout button positioning */
      #logout {
        position: fixed;
        bottom: 10px;
        right: 20px;
        z-index: 1000;
      }

      #logout .button {
        padding: 0px 20px;
      }

      /* Profile image style */
      #profileImage {
        width: 150px;
        height: 150px;
        border-radius: 50%;
        object-fit: cover;
        margin-bottom: 20px;
      }

      #profileImageContainer {
        text-align: center;
        margin-bottom: 20px;
      }
    </style>
  </head>
  <body class="is-preload">
    <div id="wrapper">
      <header id="header">
        <h1>User Information</h1>
        <p>Review and update your profile</p>
      </header>
      <div class="well">
        <ul class="nav nav-tabs">
          <li class="active"><a href="#home" data-toggle="tab">Profile</a></li>
          <li><a href="#password" data-toggle="tab">Password</a></li>
        </ul>
        <div id="myTabContent" class="tab-content">
          <div class="tab-pane active in" id="home">
            <!-- Profile Image Section -->
            <div id="profileImageContainer">
              <img id="profileImage" src="" alt="Profile Image">
              <br>
              <input type="file" id="uploadImage" accept="image/*">
            </div>

            <form id="tab">
              <label>Username</label>
              <input type="text" id="username" class="input-xlarge" value="fixedUsername" readonly>
              <label>Name</label>
              <input type="text" id="name" class="input-xlarge" value="name" readonly>
              <label>Email</label>
              <input type="text" id="email" class="input-xlarge" value="fixedEmail@example.com" readonly>
              <label>Address</label>
              <input type="text" id="address" class="input-xlarge" value="fixedAddress" readonly>
            </form>
          </div>
          <div class="tab-pane" id="password">
            <form id="passwordForm">
              <label>New Password</label>
              <input type="password" id="newPassword" class="input-xlarge">
              <button class="btn btn-primary" type="button" onclick="changePassword()">Change Password</button>
            </form>
          </div>
        </div>
      </div>

      <div id="updateModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="updateModalLabel" aria-hidden="true">
        <div class="modal-header">
          <h3 id="updateModalLabel">Update User Information</h3>
        </div>
        <div class="modal-body">
          <form id="updateForm">
            <label>Username</label>
            <input type="text" id="updateUsername" value="fixedUsername" class="input-xlarge">
            <label>Name</label>
            <input type="text" id="updateName" value="fixedName" class="input-xlarge">
            <label>Email</label>
            <input type="text" id="updateEmail" value="fixedEmail@example.com" class="input-xlarge">
            <label>Address</label>
            <input type="text" id="updateAddress" value="fixedAddress" class="input-xlarge">
          </form>
        </div>
        <div class="actions">
          <button class="btn btn-primary" type="button" onclick="updateUserInfo()">Update</button>
        </div>
      </div>

      <section id="logout">
        <ul class="actions">
          <li><a href="login.html" class="button primary" id="logoutButton">Log Out</a></li>
        </ul>
      </section>

      <footer id="footer">
        <section>
          <p class="copyright">&copy; Untitled. Design: <a href="https://html5up.net">HTML5 UP</a>.</p>
        </section>
      </footer>
    </div>

    <script>
      window.onload = function() {
        // Load stored user data
        document.getElementById("username").value = localStorage.getItem("username") || "fixedUsername";
        document.getElementById("name").value = localStorage.getItem("name") || "fixedName";
        document.getElementById("email").value = localStorage.getItem("email") || "fixedEmail@example.com";
        document.getElementById("address").value = localStorage.getItem("address") || "fixedAddress";

        // Load stored profile image
        const savedImage = localStorage.getItem("profileImage");
        if (savedImage) {
          document.getElementById("profileImage").src = savedImage;
        }
      };

      // Update user information
      function updateUserInfo() {
        const username = document.getElementById('updateUsername').value;
        const name = document.getElementById('updateName').value;
        const email = document.getElementById('updateEmail').value;
        const address = document.getElementById('updateAddress').value;

        if (!username || !email) {
          alert('Please fill in all required fields.');
          return;
        }

        localStorage.setItem("username", username);
        localStorage.setItem("name", name);
        localStorage.setItem("email", email);
        localStorage.setItem("address", address);

        // Update values in input fields
        document.getElementById('username').value = username;
        document.getElementById('name').value = name;
        document.getElementById('email').value = email;
        document.getElementById('address').value = address;

        alert("Updated Successfully");
      }

      // Change password
      function changePassword() {
        const newPassword = document.getElementById('newPassword').value;
        console.log('Changing password to:', newPassword);
      }

      // Handle profile image upload
      document.getElementById('uploadImage').addEventListener('change', function(event) {
        const file = event.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = function(e) {
            // Set the profile image to the uploaded image
            document.getElementById('profileImage').src = e.target.result;
            // Save the image in localStorage
            localStorage.setItem("profileImage", e.target.result);
          };
          reader.readAsDataURL(file);
        }
      });

      document.querySelector('#logout .button').addEventListener('click', function() {
        localStorage.setItem('logInFlag', 'false');
        window.location.href = 'main.html';
      });
    </script>
  </body>
</html>
