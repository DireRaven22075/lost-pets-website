<!DOCTYPE html>
<html lang="ko" >
  <head>
    <title>게시글 작성</title>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, user-scalable=no"
    />
    <link rel="stylesheet" type="text/css" href="/src/css/write.css" />
  </head>
  <body>
    <div class="wrapper">
      <h1>게시글 작성</h1>
      <form id="postForm">
        <!-- 카테고리부터 본문까지를 회색 배경으로 묶기 -->
        <div class="form-section">
          <label for="title">제목</label>
          <input
            type="text"
            id="title"
            name="title"
            placeholder="제목을 입력하세요"
            required
          />

          <label for="files">파일 첨부</label>
          <input type="file" id="uploadImage" name="files" accept="image/*" />

          <label for="content">본문</label>
          <textarea
            id="content"
            name="content"
            placeholder="본문 내용을 작성하세요"
            required
          ></textarea>
        </div>

        <button type="submit" class="submit-button">Submit</button>
      </form>
    </div>

    <script>
      // Handle form submission and store the post in local storage
      document
        .getElementById("postForm")
        .addEventListener("submit", function (event) {
          event.preventDefault();

          // Get form values
          const category = document.getElementById("category").value;
          const title = document.getElementById("title").value;
          const content = document.getElementById("content").value;
          const files = document.getElementById("uploadImage").files[0]; // Getting the uploaded file if any

          // Create post object
          const newPost = {
            category: category,
            title: title,
            content: content,
            files: files ? URL.createObjectURL(files) : null, // If file is uploaded, create object URL
            date: new Date().toLocaleString(), // Add the current date
            view: 0,
            comment: 0,
          };

          // Get existing posts from localStorage (if any)
          let posts = JSON.parse(localStorage.getItem("posts")) || [];

          // Add the new post to the list
          posts.push(newPost);

          // Save updated list back to localStorage
          localStorage.setItem("posts", JSON.stringify(posts));

          // Redirect to the list page to view the new post
          window.location.href = "report.html";
        });
    </script>
  </body>
</html>
